<head>
<link rel="stylesheet" href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css">
  <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.js" defer></script>
</head>



<body >
  <div x-data="app()" x-cloak class="antialiased sans-serif bg-gray-200">
  
    
    <div class="container mx-auto py-5">
          


          <ul class="bg-white rounded-lg shadow mb-8">
            <template x-for="(tweet, tweetIndex) in tweets" :key="tweetIndex">  
              <div>
                <li class="px-6 py-5" :class="{'border-b border-gray-200': (tweetIndex + 1) != tweets.length }">
                  <div class="flex w-full">
                    <div class="flex-shrink-0 mr-5">
                      <div class="cursor-pointer font-bold w-12 h-12 bg-gray-300 flex items-center justify-center rounded-full">
                        <span x-text="generateAvatarFromName(tweet.name)" class="uppercase text-gray-700"></span>
                      </div>
                    </div>
                    <div class="flex-1">
                      <div>
                        <strong class="font-bold text-gray-800 mr-2" x-text="tweet.name"></strong> 
                        <span x-text="tweet.username" class="text-gray-600"></span>
                        <span class="mx-1 text-gray-500">&bull;</span>
                        <span class="text-gray-600" x-text="formatDate(tweet.date)"></span>
                      </div>

                      <div class="mb-4">
                        <p x-text="tweet.tweet" class="text-gray-700"></p>
                        
         <div x-show="tweet.videoUrl">
           <br>
            <iframe width="100%" height="220" :src="tweet.videoUrl" frameborder="0"></iframe>
        </div>
              
                      </div>
                       
                      <div class="relative w-auto mb-2 border rounded-lg relative bg-gray-100 mb-4 shadow-inset overflow-hidden" x-show="tweet.tweet_images.length > 0">

                        <div class="gg-container">
                          <div class="gg-box square-gallery" style="margin: 0">
                            <template x-for="image in tweet.tweet_images"> 
                              <img class="object-cover w-full" :src="image" />   
                              
                            </template>
                            
                            
                          </div>
                        </div>
                      </div>

                      <div class="flex items-center w-full">
                        
                        

                        <div class="w-1/4 flex items-center">
                          <div @click="likeTweet(tweetIndex)" class="cursor-pointer hover:bg-gray-200 inline-flex p-2 rounded-full duration-200 transition-all ease-in-out">
                            <svg x-show="tweet.hasBeenLiked == false" class="h-6 w-6 text-gray-500"  fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                            </svg>

                            <svg x-show="tweet.hasBeenLiked == true" class="h-6 w-6 text-red-500"  viewBox="0 0 20 20" fill="currentColor">  <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"/></svg>
                          </div>
                          <div x-text="tweet.likes" class="ml-1 text-gray-600 leading-none inline-flex" :class="{'text-gray-600': tweet.hasBeenLiked == false, 'text-red-600': tweet.hasBeenLiked == true}"></div>
                        </div>

                       <div class="w-1/4 flex items-center">
                          <div @click="retweet(tweetIndex, tweet.retweets)" class="cursor-pointer hover:bg-gray-200 inline-flex p-2 rounded-full duration-200 transition-all ease-in-out">
                            <svg class="h-6 w-6" :class="{'text-gray-500': tweet.hasBeenRetweeted == false, 'text-green-500': tweet.hasBeenRetweeted == true }"  fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"/>
                            </svg>                            
                          </div>
                          <div x-text="tweet.retweets" class="ml-1 leading-none inline-flex" :class="{'text-gray-600': tweet.hasBeenRetweeted == false, 'text-green-600': tweet.hasBeenRetweeted == true}"></div>
                        </div>
                        
                      </div>
                    </div>
                  </div>
                </li>
              </div>
            </template>
          </ul>

      
      
      

    </div>
  </div>

</body>


<script>
   const MAX_TWEET_LENGTH = 140;
    const MONTH_NAMES = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

    function app() {
      return {
        tweetText: '',
        images: [],

        tweets: [
          {
            name: "John Wick",
            username: "@john1123wick",
            tweet: 'Build your own Fake Twitter Post now! Check it out @simitator.com',
            retweets: 12,
            likes: 50,
            date: "2020-04-06 12:00:00",
            tweet_images: [],
            hasBeenLiked: false,
            hasBeenRetweeted: false,
            videoUrl: "https://www.youtube.com/embed/BsVNs6-1B5s"
          },
          {
            name: "Captain America",
            username: "@capAmerica",
            tweet: 'Prank your friends or imitate celebrities. You can make fake twitter tweets in any creative way you like. Upload profile picture, select username, write message...',
            retweets: 10,
            likes: 100,
            date: "2020-04-02",
            tweet_images: [],
            hasBeenLiked: false,
            hasBeenRetweeted: false
          }
        ],
        
     
        
       

        saveTweet() {
          this.tweets.unshift({
            name: "Current User",
            username: "@current_user",
            tweet: this.tweetText,
            retweets: 0,
            likes: 0,
            date: new Date(),
            tweet_images: this.images,
            hasBeenLiked: false,
            hasBeenRetweeted: false
          });

          this.images = [];
          this.tweetText = '';
        },

        retweet(index) {
          this.tweets[index].hasBeenRetweeted ? this.tweets[index].retweets-- : this.tweets[index].retweets++;
          this.tweets[index].hasBeenRetweeted = !this.tweets[index].hasBeenRetweeted;
        },

        likeTweet(index) {
          this.tweets[index].hasBeenLiked ? this.tweets[index].likes-- : this.tweets[index].likes++;
          this.tweets[index].hasBeenLiked = !this.tweets[index].hasBeenLiked;
        },

        charactersRemaining() {
          return MAX_TWEET_LENGTH - this.tweetText.length;
        },

        tweetIsOutOfRange() {
          return (MAX_TWEET_LENGTH - this.tweetText.length) == MAX_TWEET_LENGTH || (MAX_TWEET_LENGTH - this.tweetText.length) < 0;
        },

        generateAvatarFromName(name) {
          return name.split(" ")[0].slice(0, 1) +''+ name.split(" ")[1].slice(0, 1);
        },

        formatDate(date) {
          if (!date) {
              return null;
          }
          
          const DAY_IN_MS = 86400000; // 24 * 60 * 60 * 1000
          const today = new Date();
          const yesterday = new Date(today - DAY_IN_MS);
          const d = new Date(date);
          const day = d.getDate();
            const month = MONTH_NAMES[d.getMonth()];

          const seconds = Math.round((today - d) / 1000);
            const minutes = Math.round(seconds / 60);
          const hours = Math.round(minutes / 60);

          const isToday = today.toDateString() === d.toDateString();
          // const isYesterday = yesterday.toDateString() === date.toDateString();
          // const isThisYear = today.getFullYear() === date.getFullYear();
          
          if (isToday) {
            if (seconds < 5) {
              return 'now';
            } else if (seconds < 60) {
              return `${ seconds }s`;
            } else if (minutes < 60) {
              return `${ minutes }m`;
            } else {
              return `${ hours }h`;
            }
          } else {
            return month +' '+ day;
          }
        }
      }
    }
</script>


      

